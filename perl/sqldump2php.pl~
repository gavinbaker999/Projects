#!/usr/bin/perl -w
if (@ARGV != 1) {die "Wrong number of command arguments\n";}
$a = $ARGV[0];

open(IN,"$a.sql") || die "Can't open file for reading $a.sql\n";
open(SQL,">$a.php") || die "Can't open file for writing $a.php\n";
print SQL "<html><head></head><body>\n<?\n";
print SQL "\$link = mysql_connect('localhost', 'root', 'joide33');\n";
print SQL "mysql_select_db('endhousesoftware_com_-_endhousesoftware');\n";

print "SQL Dump to PHP Converter. Version 1.00\n";
print "(c) End House Software 2009\n";

$out = "";
while (<IN>) {
	$line = $_;
	chomp($line);
	next if /^$/; # ignore blank lines
	next if /^--/; # ignore comment lines
	next if /^./*/!/;
	
	$out = $out . $line;
	if (/;$/) {
		chop ($out); # remove the ; character
		print SQL "\$result = mysql_query(\"$out\");\n";
		$out = "";
		next;
	}
}

close(IN);
print SQL "\nmysql_close(\$link);\n?>\n</body></html>\n";
close(SQL);


